webpackJsonp([3],{"5dBV":function(e,t,a){e.exports={default:a("quu5"),__esModule:!0}},CHlY:function(e,t,a){var r=a("kM2E"),s=a("bs6G");r(r.S+r.F*(Number.parseFloat!=s),"Number",{parseFloat:s})},JHkS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("5dBV"),s=a.n(r),i=a("bOdI"),o=a.n(i),l=a("mtWM"),n=a.n(l),d={data:function(){return{tabform:[],form:{type:[]},fileList2:[],standardsList:[],fileList:[],params:this.$route.params,upData:{type:3},headers:{token:localStorage.getItem("currentUser_token")},myInfo:{idCardUrl:""},dialogImageUrl:"",dialogVisible:!1,save:"",table1:[],table2:[],id:"",tableData:[],baseURl:"http://apitest.tianyushangyi.com",actionUrl:"http://apitest.tianyushangyi.com/file/upload?token="+localStorage.getItem("currentUser_token"),token:"",currentPage:1,currentSize:10,pageNum:0,standardSaveFlag:!1,addPlanRoute:[{productId:"",count:""}],optionty:"",selVal:"",no:"",value:"",dd:"",dddd:"",centerDialogVisible:!0,dialogTableVisible:!1,editId:"",ruleForm:o()({commodityType:"",feature:"产品nb",desc:"",applyPerson:"",majorPath:"",picPath:"",specificationIds:"",name:"",price:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:""},"desc",""),ruleForm1:{id:"",name:"",commodityType:"",feature:"",desc:"",applyPerson:"",majorPath:"",picPath:"",specificationIds:""},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],date1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],date2:[{type:"date",required:!0,message:"请选择时间",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],resource:[{required:!0,message:"请选择活动资源",trigger:"change"}],desc:[{required:!0,message:"请填写活动形式",trigger:"blur"}]}}},methods:{toBack:function(){history.go(-1)},gettoken:function(){this.token=localStorage.getItem("currentUser_token")},sublist:function(){var e=this,t=localStorage.getItem("currentUser_token");n.a.defaults.headers.post.token=t,n()({method:"post",url:e.baseURl+"/commodity/edit?id="+e.params.ta_id,data:""}).then(function(t){if("0"==t.data.code){e.$message({message:"跳转成功",type:"success"}),console.log("详情成功"),e.ruleForm1.name=t.data.data.name,e.ruleForm1.commodityType=t.data.data.commodityType,e.ruleForm1.feature=t.data.data.feature,e.ruleForm1.desc=t.data.data.desc,e.ruleForm1.applyPerson=t.data.data.applyPerson,e.getDetailImf(t.data.data.specifications),e.dd=t.data.data.majorPath,e.dddd=t.data.data.picPath;for(var a=t.data.data.picPath.split(";"),r=0;r<a.length;r++)null!=a[r]&&void 0!=a[r]&&""!=a[r]&&(e.table2.push(a[r]),e.fileList2.push({url:a[r]}));e.myInfo.idCardUrl=t.data.data.majorPath,e.ruleForm1.majorPath=t.data.data.majorPath,e.tabform.map(function(t,a){e.table1.push(t.id)})}})},getDetailImf:function(e){for(var t=this,a=0;a<e.length;a++){var r=e[a];n()({method:"get",url:t.baseURl+"/specification/edit?id="+r.id,data:""}).then(function(e){if("0"==e.data.code){var a=e.data.data;t.table1.push(a.id),t.standardsList.push({id:a.id,data:{spec2prod:a.spec2prod,name:a.name,price:Number(a.price)}})}})}},submitForm:function(e){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;alert("submit!")})},resetForm:function(e){this.$refs[e].resetFields()},getValue:function(e){this.tableData.find(function(t){return t.id===e})},addCol:function(){this.addPlanRoute.push({count:""})},delCol:function(e){this.addPlanRoute.splice(e,1)},standardlist:function(){var e=this;console.log("请求加载");var t=localStorage.getItem("currentUser_token");n.a.defaults.headers.post.token=t,n()({method:"post",url:this.baseURl+"/product/list",data:{pageSize:1e4,pageNum:1}}).then(function(t){"0"==t.data.code&&(e.tableData=t.data.data.rows)})},specificationADD:function(){},addStandard:function(){this.dialogTableVisible=!0,this.addPlanRoute=[{count:""}],this.ruleForm.name="",this.ruleForm.price=""},eidtStandard:function(e){var t=this.standardsList[e];this.editId=t.id,this.addPlanRoute=t.data.spec2prod,this.ruleForm.name=t.data.name,this.ruleForm.price=t.data.price,this.dialogTableVisible=!0},delStandard:function(e){this.standardsList.splice(e,1),this.table1.splice(e,1)},standardSave:function(){var e=this;if(""!=e.ruleForm.name&&void 0!=e.ruleForm.name&&null!=e.ruleForm.name)if(""!=e.ruleForm.price&&void 0!=e.ruleForm.price&&null!=e.ruleForm.price){for(var t=0;t<e.addPlanRoute.length;t++){var a=e.addPlanRoute[t].count;if(""==a||void 0==a||null==a)return void e.$message({message:"第"+t+"条服务信息数量不能为空",type:"error"});if(s()(a)<=0)return void e.$message({message:"第"+t+"条服务信息数量大于零",type:"error"})}e.standardSaveFlag||(e.standardSaveFlag=!0,n()({method:"post",url:e.baseURl+"/specification/add",data:{spec2prod:e.addPlanRoute,name:e.ruleForm.name,price:Number(e.ruleForm.price)}}).then(function(t){if("0"==t.data.code){var a=!1,r="";""!=e.editId&&null!=e.editId&&void 0!=e.editId&&e.table1.forEach(function(t,s){t==e.editId&&(r=s,a=!0)}),a?e.table1[r]=t.data.data.specificationId:e.table1.push(t.data.data.specificationId),e.dialogTableVisible=!1,e.$message({message:"成功",type:"success"}),a?e.standardsList[r]={id:t.data.data.specificationId,data:{spec2prod:e.addPlanRoute,name:e.ruleForm.name,price:Number(e.ruleForm.price)}}:e.standardsList.push({id:t.data.data.specificationId,data:{spec2prod:e.addPlanRoute,name:e.ruleForm.name,price:Number(e.ruleForm.price)}}),setTimeout(function(){e.standardSaveFlag=!1},100),e.editId=""}else e.standardSaveFlag=!1,e.$message({message:t.data.desc,type:"error"})}))}else e.$message({message:"价格不能为空",type:"error"});else e.$message({message:"规格名称不能为空",type:"error"})},checkVal:function(e){return""!=e&&null!=e&&void 0!=e},savebig:function(){var e,t,a=this,r=a.table2,s=a.table1;e=r.join(";"),t=s.join(";"),a.checkVal(a.ruleForm1.majorPath)?a.checkVal(a.ruleForm1.name)?a.checkVal(a.ruleForm1.feature)?a.checkVal(a.ruleForm1.commodityType)?a.checkVal(a.ruleForm1.applyPerson)?a.checkVal(a.ruleForm1.desc)?n()({method:"post",url:a.baseURl+"/commodity/update",data:{id:a.params.ta_id,name:a.ruleForm1.name,commodityType:a.ruleForm1.commodityType,feature:a.ruleForm1.feature,desc:a.ruleForm1.desc,applyPerson:a.ruleForm1.applyPerson,majorPath:a.ruleForm1.majorPath,isPutOn:!0,picPath:e,specificationIds:t}}).then(function(e){"0"==e.data.code?(a.$message({message:"添加成功",type:"success"}),a.$router.push({name:"catalogue"})):a.$message({message:"添加失败从新输入",type:"error"})}):a.$message({type:"error",message:"详细介绍必填"}):a.$message({type:"error",message:"适合人群必填"}):a.$message({type:"error",message:"商品类别必填"}):a.$message({type:"error",message:"商品特色必填"}):a.$message({type:"error",message:"商品名称必填"}):a.$message({type:"error",message:"商品图片必填"})},handleSuccess:function(e,t,a){console.log(e);0==e.code?(this.myInfo.idCardUrl=e.data.url,this.ruleForm1.majorPath=e.data.url):this.$message({message:e.desc,type:"error"})},handlePreview:function(e){console.log(e)},handleRemove2:function(e,t){console.log(e,t),console.log(this.table2);var a=this;a.table2.forEach(function(t,r){t==e.url&&(a.table2.splice(r,1),a.fileList2.splice(r,1))})},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},beforeRemove2:function(e,t){console.log(e)},handleExceed:function(e,t){t=[],this.$message.warning("当前限制选择 1个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},handleRemove:function(e,t){this.myInfo.idCardUrl="",this.ruleForm1.majorPath=""},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccess2:function(e,t,a){console.log(e);0==e.code?(this.table2.push(e.data.url),this.fileList2.push({url:e.data.url})):this.$message({message:"上传失败请删除图片重新上传",type:"error"})}},mounted:function(){this.standardlist(),this.sublist()}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"TY-content"},[e._m(0),e._v(" "),a("div",{staticClass:"TY-right"},[a("div",{staticClass:"ty-rig-top"},[a("el-form",{ref:"ruleForm1",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm1,"label-width":"100px"}},[a("el-form-item",{staticClass:"is-required",attrs:{label:"商品名称",prop:"name"}},[a("el-input",{model:{value:e.ruleForm1.name,callback:function(t){e.$set(e.ruleForm1,"name",t)},expression:"ruleForm1.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"is-required",attrs:{label:"商品特色",prop:"feature"}},[a("el-input",{model:{value:e.ruleForm1.feature,callback:function(t){e.$set(e.ruleForm1,"feature",t)},expression:"ruleForm1.feature"}})],1),e._v(" "),a("el-form-item",{staticClass:"is-required",attrs:{label:"商品类别",prop:"commodityType"}},[a("el-select",{attrs:{placeholder:"请选择商品类别"},model:{value:e.ruleForm1.commodityType,callback:function(t){e.$set(e.ruleForm1,"commodityType",t)},expression:"ruleForm1.commodityType"}},[a("el-option",{attrs:{label:"服务",value:"服务"}}),e._v(" "),a("el-option",{attrs:{label:"货物",value:"货物"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"is-required",attrs:{label:"适合人群",prop:"applyPerson"}},[a("el-input",{model:{value:e.ruleForm1.applyPerson,callback:function(t){e.$set(e.ruleForm1,"applyPerson",t)},expression:"ruleForm1.applyPerson"}})],1),e._v(" "),a("el-form-item",{staticClass:"is-required",attrs:{label:"详细介绍",prop:"name"}},[a("el-input",{staticStyle:{width:"200px",resize:"none"},attrs:{type:"textarea"},model:{value:e.ruleForm1.desc,callback:function(t){e.$set(e.ruleForm1,"desc",t)},expression:"ruleForm1.desc"}})],1),e._v(" "),a("div",{staticClass:"ty-xuanze"},[a("el-form-item",{staticClass:"is-required",attrs:{label:"商品图片"}},[a("img",{attrs:{src:e.myInfo.idCardUrl,alt:""}}),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{action:e.actionUrl,headers:e.headers,data:e.upData,accept:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF","on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"before-remove":e.beforeRemove,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("商品图片如果更换请从新点击上传")])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"规格",prop:"desc"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.standardsList.length>0,expression:"standardsList.length>0"}],staticStyle:{"margin-bottom":"10px"}},e._l(e.standardsList,function(t,r){return a("el-button",{staticStyle:{margin:"0 10px 10px 0"},attrs:{type:"primary"}},[e._v("\n              "+e._s(t.data.name)),a("i",{staticClass:"el-icon-edit el-icon--right",on:{click:function(t){e.eidtStandard(r)}}}),a("i",{staticClass:"el-icon-delete el-icon--right",on:{click:function(t){e.delStandard(r)}}})])})),e._v(" "),a("el-button",{on:{click:e.addStandard}},[e._v("+ 添加")])],1)],1)],1),e._v(" "),a("div",{staticClass:"ty-rig-bottom"},[a("el-upload",{attrs:{limit:5,action:e.actionUrl,headers:e.headers,data:e.upData,"file-list":e.fileList2,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,accept:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF","on-success":e.handleSuccess2,"before-remove":e.beforeRemove2,"on-remove":e.handleRemove2}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),e._v(" "),e._m(1)],1),e._v(" "),a("div",{staticClass:"ty-right-anniu"},[a("el-button",{on:{click:e.savebig}},[e._v("确认")]),e._v(" "),a("el-button",{on:{click:e.toBack}},[e._v("取消")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"规格信息",visible:e.dialogTableVisible,modal:!1,center:!0},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"规格名称:",prop:"name"}},[a("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格:",prop:"name"}},[a("el-input",{model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}})],1)],1),e._v(" "),a("span",[e._v("服务信息")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.addPlanRoute,border:""}},[a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.count,callback:function(a){e.$set(t.row,"count",a)},expression:"scope.row.count"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"productId",label:"服务名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"状态",valueKey:"id"},on:{change:e.getValue},model:{value:t.row.productId,callback:function(a){e.$set(t.row,"productId",a)},expression:"scope.row.productId"}},e._l(e.tableData,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){e.delCol(t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-button",{on:{click:e.addCol}},[e._v("添加列按钮")]),e._v(" "),a("div",{staticClass:"ty-right-anniu"},[a("el-button",{attrs:{disabled:e.standardSaveFlag},on:{click:e.standardSave}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogTableVisible=!1,e.editId=""}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"TY-left"},[t("div",{staticClass:"ty-bag"},[t("div",{staticClass:"tyleft-img1"},[t("p",[this._v("基本信息")])]),this._v(" "),t("div",{staticClass:"tyleft-img3"},[t("p",[this._v("销售属性")])]),this._v(" "),t("div",{staticClass:"tyleft-img2"},[t("p",[this._v(" 图片信息")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ty-bottom-upload"},[t("span",[this._v("最多可以上传5张图片，建议尺寸800*800px")])])}]};var u=a("VU/8")(d,c,!1,function(e){a("r/t6"),a("mZ7u")},"data-v-682b834a",null);t.default=u.exports},bs6G:function(e,t,a){var r=a("7KvD").parseFloat,s=a("mnVu").trim;e.exports=1/r(a("hyta")+"-0")!=-1/0?function(e){var t=s(String(e),3),a=r(t);return 0===a&&"-"==t.charAt(0)?-0:a}:r},hyta:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},mZ7u:function(e,t){},mnVu:function(e,t,a){var r=a("kM2E"),s=a("52gC"),i=a("S82l"),o=a("hyta"),l="["+o+"]",n=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),c=function(e,t,a){var s={},l=i(function(){return!!o[e]()||"​"!="​"[e]()}),n=s[e]=l?t(u):o[e];a&&(s[a]=n),r(r.P+r.F*l,"String",s)},u=c.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(n,"")),2&t&&(e=e.replace(d,"")),e};e.exports=c},quu5:function(e,t,a){a("CHlY"),e.exports=a("FeBl").Number.parseFloat},"r/t6":function(e,t){}});
//# sourceMappingURL=3.1fb9fa6b9aa74f495b2c.js.map